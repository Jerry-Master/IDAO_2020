pred1 <- predict(mod1.v2, n.ahead=12)
pred2 <- predict(mod2.v2, n.ahead=12)
point1 <- pred1$pred
point2 <- pred2$pred
up1 <- point1 + pred1$se * 1.96
lo1 <- point1 - pred1$se * 1.96
up2 <- point2 + pred2$se * 1.96
lo2 <- point2 - pred2$se * 1.96
ts.plot(atur,lo1,up1,point1,lty=c(1,2,2,1),col=c(1,4,4,2),xlim=c(2013,2019), type="o", main="Predicciones de 2019 según el modelo 1")
abline(v=2013:2019,lty=3,col=4)
ts.plot(atur,lo2,up2,point2,lty=c(1,2,2,1),col=c(1,4,4,2),xlim=c(2013,2019), type="o", main="Predicciones de 2019 según el modelo 1")
abline(v=2013:2019,lty=3,col=4)
pred1 <- predict(mod1.v2, n.ahead=12)
pred2 <- predict(mod2.v2, n.ahead=12)
point1 <- pred1$pred
point2 <- pred2$pred
up1 <- point1 + pred1$se * 1.96
lo1 <- point1 - pred1$se * 1.96
up2 <- point2 + pred2$se * 1.96
lo2 <- point2 - pred2$se * 1.96
ts.plot(atur,lo1,up1,point1,lty=c(1,2,2,1),col=c(1,4,4,2),xlim=c(2013,2019), type="o", main="Predicciones de 2019 según el modelo 1")
abline(v=2013:2019,lty=3,col=4)
ts.plot(atur,lo2,up2,point2,lty=c(1,2,2,1),col=c(1,4,4,2),xlim=c(2013,2019), type="o", main="Predicciones de 2019 según el modelo 2")
abline(v=2013:2019,lty=3,col=4)
obs1 <- window(atur, star=c(2019, 12), end=c(2019, 12))
obs1 <- window(atur, star=c(2019, 1), end=c(2019, 12))
obs1 <- window(atur, start=c(2019, 1), end=c(2019, 12))
obs1 <- window(atur, start=c(2018, 1), end=c(2019, 12))
RMSPE=sqrt(mean(((obs1-pred1)/obs1)^2))
obs1 <- window(atur, start=c(2019, 1), end=c(2019, 12))
obs1 <- window(atur, start=c(2018, 12), end=c(2019, 12))
RMSPE=sqrt(mean(((obs1-pred1)/obs1)^2))
obs1 <- window(atur, start=c(2018, 1), end=c(2018, 12))
RMSPE=sqrt(mean(((obs1-pred1)/obs1)^2))
obs1 <- list(window(atur, start=c(2018, 1), end=c(2018, 12)))
RMSPE=sqrt(mean(((obs1-pred1)/obs1)^2))
obs1 <- c(window(atur, start=c(2018, 1), end=c(2018, 12)))
RMSPE=sqrt(mean(((obs1-pred1)/obs1)^2))
obs1
typeof(obs1)
typeof(pred1)
pred1
obs1 <- window(atur, start=c(2018, 1), end=c(2018, 12))
RMSPE=sqrt(mean(((obs1-points1)/obs1)^2))
obs1 <- window(atur, start=c(2018, 1), end=c(2018, 12))
RMSPE=sqrt(mean(((obs1-point1)/obs1)^2))
MAPE=mean(abs(obs1-point1)/obs1)
obs <- window(atur, start=c(2018, 1), end=c(2018, 12))
(RMSPE<-sqrt(mean(((obs-point1)/obs)^2)))
(MAPE<-mean(abs(obs-point1)/obs))
(RMSPE<-sqrt(mean(((obs-point2)/obs)^2)))
(MAPE<-mean(abs(obs-point2)/obs))
mean(up1-lo1)
mean(up2-lo2)
pred2020 <- predict(mod1, n.ahead=12)
point2020 <- pred2020$pred
up2020 <- point2020 + pred2020$se * 1.96
lo2020 <- point2020 - pred2020$se * 1.96
ts.plot(atur,lo2020,up2020,point2020,lty=c(1,2,2,1),col=c(1,4,4,2),xlim=c(2013,2019), type="o", main="Predicciones de 2019 según el modelo 1")
abline(v=2013:2019,lty=3,col=4)
pred2020 <- predict(mod1, n.ahead=12)
point2020 <- pred2020$pred
up2020 <- point2020 + pred2020$se * 1.96
lo2020 <- point2020 - pred2020$se * 1.96
ts.plot(atur,lo2020,up2020,point2020,lty=c(1,2,2,1),col=c(1,4,4,2),xlim=c(2013,2019), type="o", main="Predicciones de 2020 según el modelo 1")
abline(v=2013:2019,lty=3,col=4)
pred2020 <- predict(mod1, n.ahead=12)
point2020 <- pred2020$pred
up2020 <- point2020 + pred2020$se * 1.96
lo2020 <- point2020 - pred2020$se * 1.96
ts.plot(atur,lo2020,up2020,point2020,lty=c(1,2,2,1),col=c(1,4,4,2),xlim=c(2013,2019), type="o", main="Predicciones de 2020 según ARIMA(1,1,0)(0,0,1)12")
abline(v=2013:2019,lty=3,col=4)
pred2020 <- predict(mod1, n.ahead=12)
point2020 <- pred2020$pred
up2020 <- point2020 + pred2020$se * 1.96
lo2020 <- point2020 - pred2020$se * 1.96
ts.plot(atur,lo2020,up2020,point2020,lty=c(1,2,2,1),col=c(1,4,4,2),xlim=c(2013,2019), type="o", main="Predicciones de 2020 según ARIMA(1,1,0)(0,1,1)12")
abline(v=2013:2019,lty=3,col=4)
pred2020 <- predict(mod1, n.ahead=12)
point2020 <- pred2020$pred
up2020 <- point2020 + pred2020$se * 1.96
lo2020 <- point2020 - pred2020$se * 1.96
ts.plot(atur,lo2020,up2020,point2020,lty=c(1,2,2,1),col=c(1,4,4,2),xlim=c(2013,2020), type="o", main="Predicciones de 2020 según ARIMA(1,1,0)(0,1,1)12")
abline(v=2013:2020,lty=3,col=4)
pred2020 <- predict(mod1, n.ahead=24)
point2020 <- pred2020$pred
up2020 <- point2020 + pred2020$se * 1.96
lo2020 <- point2020 - pred2020$se * 1.96
ts.plot(atur,lo2020,up2020,point2020,lty=c(1,2,2,1),col=c(1,4,4,2),xlim=c(2013,2020), type="o", main="Predicciones de 2020 según ARIMA(1,1,0)(0,1,1)12")
abline(v=2013:2020,lty=3,col=4)
pred2020 <- predict(mod1, n.ahead=24)
point2020 <- pred2020$pred
up2020 <- point2020 + pred2020$se * 1.96
lo2020 <- point2020 - pred2020$se * 1.96
ts.plot(atur,lo2020,up2020,point2020,lty=c(1,2,2,1),col=c(1,4,4,2),xlim=c(2013,2021), type="o", main="Predicciones de 2020 según ARIMA(1,1,0)(0,1,1)12")
abline(v=2013:2021,lty=3,col=4)
pred2020
pred1 <- predict(mod1.v2, n.ahead=12)
pred2 <- predict(mod2.v2, n.ahead=12)
point1 <- pred1$pred
point2 <- pred2$pred
up1 <- point1 + pred1$se * 1.96
lo1 <- point1 - pred1$se * 1.96
up2 <- point2 + pred2$se * 1.96
lo2 <- point2 - pred2$se * 1.96
ts.plot(atur,lo1,up1,point1,lty=c(1,2,2,1),col=c(1,4,4,2),xlim=c(2013,2019), type="o", main="Predicciones de 2018 según el modelo 1")
abline(v=2013:2019,lty=3,col=4)
ts.plot(atur,lo2,up2,point2,lty=c(1,2,2,1),col=c(1,4,4,2),xlim=c(2013,2019), type="o", main="Predicciones de 2018 según el modelo 2")
abline(v=2013:2019,lty=3,col=4)
pred2019 <- predict(mod1, n.ahead=12)
point2019 <- pred2019$pred
up2019 <- point2019 + pred2019$se * 1.96
lo2019 <- point2019 - pred2019$se * 1.96
ts.plot(atur,lo2019,up2019,point2019,lty=c(1,2,2,1),col=c(1,4,4,2),xlim=c(2013,2020), type="o", main="Predicciones de 2019 según ARIMA(1,1,0)(0,1,1)12")
abline(v=2013:2020,lty=3,col=4)
oil
data(oil)
setwd("~/Desktop/CFIS segundo curso/IDAO/Fase inicial/data")
sat <- read.csv("train.csv")
head(sat)
serie <- sat[sat$sat_id==20,]
head(serie)
plot(serie$x)
seriex <- ts(serie$x, freq=24)
seriex <- ts(serie$x, freq=24)
plot(seriex)
plot(decompose(seriex))
seriex.d24 <- diff(seriex.d24)
seriex.d24 <- diff(seriex)
plot(seriex.d24)
abline(h=0, lty=2)
monthplot(seriex)
monthplot(seriex-d24)
monthplot(seriex.d24)
seriex.d24.d24 <- diff(seriex.d24)
plot(seriex.d24.d24)
abline(h=0, lty=2)
monthplot(seriex.d24.d24)
seriex.d24.d24.d24 <- diff(seriex.d24.d24)
plot(seriex.d24.d24.d4)
seriex.d24.d24.d24 <- diff(seriex.d24.d24)
plot(seriex.d24.d24.d24)
abline(h=0, lty=2)
monthplot(seriex.d24.d24.d24)
var(seriex)
var(seriex.d24)
var(seriex.d24.d24)
var(seriex.d24.d24.d24)
serie.d24.d1 <- diff(seriex.d24)
plot(serie.d24.d1)
abline(h=0, lty=2)
serie.d24.d1 <- diff(diff(seriex.d24))
plot(serie.d24.d1)
abline(h=0, lty=2)
serie.d24.d1 <- diff(diff(diff(seriex.d24)))
plot(serie.d24.d1)
abline(h=0, lty=2)
serie.d24.d1 <- diff(seriex.d24)
plot(serie.d24.d1)
abline(h=0, lty=2)
var(serie.d24)
var(seriex.d24)
var(seriex.d24.d1)
seriex.d24.d1 <- diff(seriex.d24)
plot(seriex.d24.d1)
abline(h=0, lty=2)
var(seriex.d24)
var(seriex.d24.d1)
var(diff(seriex.d24.d1))
boxplot(seriex~floor(time(seriex)))
boxplot(seriex~floor(time(seriex)/2))
par(mfrow=c(1,2))
acf(seriex.d24, col=c(2,rep(1,23)))
pacf(seriex.d24, col=c(rep(1,23),2))
par(mfrow=c(1,2))
acf(seriex.d24, col=c(2,rep(1,23)), lag=100)
pacf(seriex.d24, col=c(rep(1,23),2), lag=100)
par(mfrow=c(1,2))
acf(seriex.d24, col=c(2,rep(1,23)), lag=100)
pacf(seriex.d24, col=c(rep(1,23),2), lag=100)
mod <- arima(seriex, order=c(1,1,0), seasonal=list(order=c(1,1,0), frequency=24))
res <- resid(mod)
plot(res)
plot(res)
qqnorm(res)
hist(res)
plot(res)
qqnorm(res)
hist(res, breaks=20, frequency=F)
plot(res)
qqnorm(res)
hist(res, breaks=20, freq=F)
plot(res)
qqnorm(res)
qqline(res)
hist(res, breaks=20, freq=F)
par(mfrow=c(1,2))
acf(seriex.d24.d24, col=c(2,rep(1,23)), lag=100)
pacf(seriex.d24.d24, col=c(rep(1,23),2), lag=100)
par(mfrow=c(1,2))
acf(seriex.d24.d24.d24, col=c(2,rep(1,23)), lag=100)
pacf(seriex.d24.d24.d24, col=c(rep(1,23),2), lag=100)
par(mfrow=c(1,2))
acf(seriex.d24.d24, col=c(2,rep(1,23)), lag=100)
pacf(seriex.d24.d24, col=c(rep(1,23),2), lag=100)
par(mfrow=c(1,2))
acf(diff(seriex.d24.d24), col=c(2,rep(1,23)), lag=100)
pacf(diff(seriex.d24.d24), col=c(rep(1,23),2), lag=100)
par(mfrow=c(1,2))
acf(diff(seriex.d24.d24.d24), col=c(2,rep(1,23)), lag=100)
pacf(diff(seriex.d24.d24.d24), col=c(rep(1,23),2), lag=100)
par(mfrow=c(1,2))
acf(diff(seriex.d24.d24.d24,24), col=c(2,rep(1,23)), lag=100)
pacf(diff(seriex.d24.d24.d24,24), col=c(rep(1,23),2), lag=100)
seriex.d24 <- diff(seriex, 24)
plot(seriex.d24)
abline(h=0, lty=2)
monthplot(seriex.d24)
seriex.d24.d24 <- diff(seriex.d24, 24)
plot(seriex.d24.d24)
abline(h=0, lty=2)
monthplot(seriex.d24.d24)
seriex.d24.d24.d24 <- diff(seriex.d24.d24,24)
plot(seriex.d24.d24.d24)
abline(h=0, lty=2)
monthplot(seriex.d24.d24.d24)
var(seriex)
var(seriex.d24)
var(seriex.d24.d24)
var(seriex.d24.d24.d24)
seriex.d24.d24.d1 <- diff(seriex.d24.d24)
plot(seriex.d24.d24.d1)
abline(h=0, lty=2)
var(seriex.d24.d24)
var(seriex.d24.d24.d1)
var(diff(seriex.d24.d24.d1))
par(mfrow=c(1,2))
acf(seriex.d24.d24.d1, col=c(2,rep(1,23)), lag=100)
pacf(seriex.d24.d24.d1, col=c(rep(1,23),2), lag=100)
par(mfrow=c(1,2))
acf(seriex.d24.d24, col=c(2,rep(1,23)), lag=100)
pacf(seriex.d24.d24, col=c(rep(1,23),2), lag=100)
mod <- arima(seriex, order=c(0,1,2), seasonal=list(order=c(0,2,1), frequency=24))
res <- resid(mod)
plot(res)
qqnorm(res)
qqline(res)
hist(res, breaks=20, freq=F)
plot(res)
qqnorm(res)
qqline(res)
hist(res, breaks=40, freq=F)
plot(res)
qqnorm(res)
qqline(res)
hist(res, breaks=40, freq=F)
tsdiag(mod,40)
mod <- arima(seriex, order=c(1,1,1), seasonal=list(order=c(1,2,1), frequency=24))
res <- resid(mod)
plot(res)
qqnorm(res)
qqline(res)
hist(res, breaks=40, freq=F)
tsdiag(mod,40)
mod <- arima(seriex, order=c(1,1,1), seasonal=list(order=c(2,2,1), frequency=24))
mod <- arima(seriex, order=c(1,1,1), seasonal=list(order=c(2,2,0), frequency=24))
mod <- arima(seriex, order=c(1,1,1), seasonal=list(order=c(2,1,0), frequency=24))
plot(res)
qqnorm(res)
qqline(res)
hist(res, breaks=40, freq=F)
tsdiag(mod,40)
mod <- arima(seriex, order=c(1,1,1), seasonal=list(order=c(1,1,0), frequency=24))
mod <- arima(seriex, order=c(1,1,1), seasonal=list(order=c(0,2,1), frequency=24))
res <- resid(mod)
mod <- arima(seriex, order=c(48,0,0))
mod <- arima(seriex, order=c(24,0,0))
mod <- arima(seriex, order=c(24,0,0))
mod <- arima(seriex, order=c(1,1,1), seasonal=list(order=c(0,2,1), frequency=24))
res <- resid(mod)
mod <- arima(seriex, order=c(1,1,1), seasonal=list(order=c(0,2,1), frequency=24))
res <- resid(mod)
plot(res)
qqnorm(res)
qqline(res)
hist(res, breaks=40, freq=F)
tsdiag(mod,40)
plot(serie$epoch)
head(serie$epoch)
serie$epoch <- as.numeric(as.POSIXct(serie$epoch))
head(serie$epoch)
plot(serie$epoch)
plot(diff(serie$epoch))
for (i in 2:length(serie$epoch)){
if (serie$epoch[i-1] == serie$epoch[i]){
print(i)
}
}
rm.list <- c()
for (i in 2:length(serie$epoch)){
if (serie$epoch[i-1] == serie$epoch[i]){
rm.list <- c(rm.list, i)
}
}
serie <- serie[-rm.list,]
plot(diff(serie$x))
plot(diff(serie$epoch))
seriex <- ts(serie$x, freq=24)
plot(seriex)
seriex.d24 <- diff(seriex, 24)
plot(seriex.d24)
abline(h=0, lty=2)
monthplot(seriex.d24)
plot(serie$epoch)
plot(serie$x)
plot(serie$x,type="l")
seriex <- ts(serie$x, freq=4)
plot(seriex)
seriex <- ts(serie$x, freq=4)
plot(seriex)
seriex.d24 <- diff(seriex, 4)
plot(seriex.d24)
abline(h=0, lty=2)
monthplot(seriex.d4)
monthplot(seriex.d24)
seriex.d24.d24 <- diff(seriex.d24, 4)
plot(seriex.d24.d24)
abline(h=0, lty=2)
monthplot(seriex.d24.d24)
seriex.d24.d24.d24 <- diff(seriex.d24.d24,4)
plot(seriex.d24.d24.d24)
abline(h=0, lty=2)
monthplot(seriex.d24.d24.d24)
var(seriex)
var(seriex.d24)
var(seriex.d24.d24)
var(seriex.d24.d24.d24)
seriex.d24.d24.d1 <- diff(seriex.d24.d24)
plot(seriex.d24.d24.d1)
abline(h=0, lty=2)
var(seriex.d24.d24)
var(seriex.d24.d24.d1)
var(diff(seriex.d24.d24.d1))
boxplot(seriex~floor(time(seriex)/2))
boxplot(seriex~floor(time(seriex)))
par(mfrow=c(1,2))
acf(seriex.d24.d24, col=c(2,rep(1,23)), lag=100)
pacf(seriex.d24.d24, col=c(rep(1,23),2), lag=100)
mod <- arima(seriex, order=c(0,0,0), seasonal=list(order=c(0,2,0), frequency=4))
res <- resid(mod)
plot(res)
qqnorm(res)
qqline(res)
hist(res, breaks=40, freq=F)
tsdiag(mod,40)
pred <- predict(mod, n.ahead=12)
pred <- predict(mod, n.ahead=12)
pre <- pred$pred
plot(seriex, pre)
pred <- predict(mod, n.ahead=12)
pre <- pred$pred
plot(seriex)
plot(seriex, xlim=c(0,20))
pred <- predict(mod, n.ahead=12)
pre <- pred$pred
plot(seriex, xlim=c(0,20))
points(pre)
pred <- predict(mod, n.ahead=12)
pre <- pred$pred
plot(seriex, xlim=c(0,20))
points(pre, type="l")
pred <- predict(mod, n.ahead=12)
pre <- pred$pred
plot(seriex, xlim=c(0,14), ylim=c(min(seriex)-1000), max(seriex)+1000)
pred <- predict(mod, n.ahead=12)
pre <- pred$pred
plot(seriex, xlim=c(0,14), ylim=c(min(seriex)-1000, max(seriex)+1000))
points(pre, type="l")
pred <- predict(mod, n.ahead=12)
pre <- pred$pred
plot(seriex, xlim=c(0,14), ylim=c(min(seriex)-1000, max(seriex)+10000))
points(pre, type="l")
pred <- predict(mod, n.ahead=12)
pre <- pred$pred
plot(seriex, xlim=c(0,14), ylim=c(min(seriex)-1000, max(seriex)+100000))
points(pre, type="l")
pred <- predict(mod, n.ahead=12)
pre <- pred$pred
plot(seriex, xlim=c(0,14), ylim=c(min(seriex)-1000, max(seriex)+100000))
points(pre, type="l", col=2)
serie <- sat[sat$sat_id==1,]
head(serie)
serie$epoch <- as.numeric(as.POSIXct(serie$epoch))
head(serie$epoch)
rm.list <- c()
for (i in 2:length(serie$epoch)){
if (serie$epoch[i-1] == serie$epoch[i]){
rm.list <- c(rm.list, i)
}
}
serie <- serie[-rm.list,]
plot(serie$x,type="l")
seriex <- ts(serie$x, freq=5)
plot(seriex)
seriex.d24 <- diff(seriex, 5)
plot(seriex.d24)
abline(h=0, lty=2)
monthplot(seriex.d24)
seriex.d24.d24 <- diff(seriex.d24, 5)
plot(seriex.d24.d24)
abline(h=0, lty=2)
monthplot(seriex.d24.d24)
seriex.d24.d24.d24 <- diff(seriex.d24.d24,5)
plot(seriex.d24.d24.d24)
abline(h=0, lty=2)
monthplot(seriex.d24.d24.d24)
seriex <- ts(serie$x, freq=4)
plot(seriex)
seriex.d24 <- diff(seriex, 4)
plot(seriex.d24)
abline(h=0, lty=2)
monthplot(seriex.d24)
seriex.d24.d24 <- diff(seriex.d24, 4)
plot(seriex.d24.d24)
abline(h=0, lty=2)
monthplot(seriex.d24.d24)
seriex.d24.d24.d24 <- diff(seriex.d24.d24,4)
plot(seriex.d24.d24.d24)
abline(h=0, lty=2)
monthplot(seriex.d24.d24.d24)
var(seriex)
var(seriex.d24)
var(seriex.d24.d24)
var(seriex.d24.d24.d24)
seriex.d24.d24.d1 <- diff(seriex.d24.d24)
plot(seriex.d24.d24.d1)
abline(h=0, lty=2)
var(seriex.d24.d24)
var(seriex.d24.d24.d1)
var(diff(seriex.d24.d24.d1))
boxplot(seriex~floor(time(seriex)))
par(mfrow=c(1,2))
acf(seriex.d24.d24, col=c(2,rep(1,23)), lag=100)
pacf(seriex.d24.d24, col=c(rep(1,23),2), lag=100)
par(mfrow=c(1,2))
acf(seriex.d24, col=c(2,rep(1,23)), lag=100)
pacf(seriex.d24, col=c(rep(1,23),2), lag=100)
par(mfrow=c(1,2))
acf(seriex.d24, col=c(2,rep(1,3)), lag=100)
pacf(seriex.d24, col=c(rep(1,3),2), lag=100)
mod <- arima(seriex, order=c(0,0,0), seasonal=list(order=c(1,2,0), frequency=4))
res <- resid(mod)
plot(res)
qqnorm(res)
qqline(res)
hist(res, breaks=40, freq=F)
tsdiag(mod,40)
mod <- arima(seriex, order=c(0,0,0), seasonal=list(order=c(0,2,0), frequency=4))
res <- resid(mod)
plot(res)
qqnorm(res)
qqline(res)
hist(res, breaks=40, freq=F)
tsdiag(mod,40)
mod <- arima(seriex, order=c(0,0,0), seasonal=list(order=c(2,2,0), frequency=4))
res <- resid(mod)
plot(res)
qqnorm(res)
qqline(res)
hist(res, breaks=40, freq=F)
tsdiag(mod,40)
mod <- arima(seriex, order=c(0,0,0), seasonal=list(order=c(1,2,1), frequency=4))
res <- resid(mod)
plot(res)
qqnorm(res)
qqline(res)
hist(res, breaks=40, freq=F)
tsdiag(mod,40)
mod <- arima(seriex, order=c(1,1,0), seasonal=list(order=c(1,2,1), frequency=4))
res <- resid(mod)
plot(res)
qqnorm(res)
qqline(res)
hist(res, breaks=40, freq=F)
tsdiag(mod,40)
mod <- arima(seriex, order=c(0,0,0), seasonal=list(order=c(0,2,1), frequency=4))
res <- resid(mod)
plot(res)
qqnorm(res)
qqline(res)
hist(res, breaks=40, freq=F)
tsdiag(mod,40)
par(mfrow=c(1,2))
acf(seriex.d24.d24, col=c(2,rep(1,3)), lag=100)
pacf(seriex.d24.d24, col=c(rep(1,3),2), lag=100)
mod <- arima(seriex, order=c(2,0,0), seasonal=list(order=c(3,2,0), frequency=4))
res <- resid(mod)
plot(res)
qqnorm(res)
qqline(res)
hist(res, breaks=40, freq=F)
tsdiag(mod,40)
pred <- predict(mod, n.ahead=12)
pre <- pred$pred
plot(seriex, xlim=c(0,14), ylim=c(min(seriex)-1000, max(seriex)+100000))
points(pre, type="l", col=2)
pred <- predict(mod, n.ahead=12)
pre <- pred$pred
lo <- pre - 1.96 * pred$se
up <- pre + 1.96 * pred$se
ts.plot(seriex,lo,up,pre,lty=c(1,2,2,1),col=c(1,4,4,2),xlim=c(0,12), ylim=c(min(seriex)-1000, max(seriex)+100000), type="o")
abline(v=0:12,lty=3,col=4)
