---
title: "R Notebook"
output: html_notebook
---


```{r}
library(readr)
library(car)
library(emmeans)
library(tables)
library(RcmdrMisc)
library(dplyr)


dd <- read_csv("train.csv")
dd$dist <- sqrt(dd$x^2 + dd$y^2 + dd$z^2)
dd$epoch <- as.numeric(as.POSIXct(dd$epoch))
dd$first <- min(dd$epoch)
dd$epoch <- dd$epoch - min(dd$epoch)
head(dd)

```


```{r}
write(toString(ddi$first[1]), file = "sin_betas.txt", append=TRUE)  

for(i in 0:599){
    print(i)
    
    ddi <- filter(dd, sat_id==i)
    t <- (ddi$epoch[25]-ddi$epoch[1])
    
    write(toString(t), file = "sin_betas.txt", append=TRUE)  
    
    lmX <- lm(ddi$x ~ sin(2*pi/t*ddi$epoch)+cos(2*pi/t*ddi$epoch)+sin(4*pi/t*ddi$epoch)+cos(4*pi/t*ddi$epoch)+sin(6*pi/t*ddi$epoch)+cos(6*pi/t*ddi$epoch)+sin(8*pi/t*ddi$epoch)+cos(8*pi/t*ddi$epoch)+sin(10*pi/t*ddi$epoch)+cos(10*pi/t*ddi$epoch))

     
    lmY <- lm(ddi$y ~ sin(2*pi/t*ddi$epoch)+cos(2*pi/t*ddi$epoch)+sin(4*pi/t*ddi$epoch)+cos(4*pi/t*ddi$epoch)+sin(6*pi/t*ddi$epoch)+cos(6*pi/t*ddi$epoch)+sin(8*pi/t*ddi$epoch)+cos(8*pi/t*ddi$epoch)+sin(10*pi/t*ddi$epoch)+cos(10*pi/t*ddi$epoch))


    lmZ <- lm(ddi$z ~ sin(2*pi/t*ddi$epoch)+cos(2*pi/t*ddi$epoch)+sin(4*pi/t*ddi$epoch)+cos(4*pi/t*ddi$epoch)+sin(6*pi/t*ddi$epoch)+cos(6*pi/t*ddi$epoch)+sin(8*pi/t*ddi$epoch)+cos(8*pi/t*ddi$epoch)+sin(10*pi/t*ddi$epoch)+cos(10*pi/t*ddi$epoch))


    lmVx <- lm(ddi$Vx ~ sin(2*pi/t*ddi$epoch)+cos(2*pi/t*ddi$epoch)+sin(4*pi/t*ddi$epoch)+cos(4*pi/t*ddi$epoch)+sin(6*pi/t*ddi$epoch)+cos(6*pi/t*ddi$epoch)+sin(8*pi/t*ddi$epoch)+cos(8*pi/t*ddi$epoch)+sin(10*pi/t*ddi$epoch)+cos(10*pi/t*ddi$epoch))

    lmVy <- lm(ddi$Vy ~ sin(2*pi/t*ddi$epoch)+cos(2*pi/t*ddi$epoch)+sin(4*pi/t*ddi$epoch)+cos(4*pi/t*ddi$epoch)+sin(6*pi/t*ddi$epoch)+cos(6*pi/t*ddi$epoch)+sin(8*pi/t*ddi$epoch)+cos(8*pi/t*ddi$epoch)+sin(10*pi/t*ddi$epoch)+cos(10*pi/t*ddi$epoch))


    lmVz <- lm(ddi$Vz ~ sin(2*pi/t*ddi$epoch)+cos(2*pi/t*ddi$epoch)+sin(4*pi/t*ddi$epoch)+cos(4*pi/t*ddi$epoch)+sin(6*pi/t*ddi$epoch)+cos(6*pi/t*ddi$epoch)+sin(8*pi/t*ddi$epoch)+cos(8*pi/t*ddi$epoch)+sin(10*pi/t*ddi$epoch)+cos(10*pi/t*ddi$epoch))
      
     write(toString(summary(lmX)$coefficients[,1]), file = "sin_betas.txt", append=TRUE)
     write(toString(summary(lmY)$coefficients[,1]), file = "sin_betas.txt", append=TRUE)
     write(toString(summary(lmZ)$coefficients[,1]), file = "sin_betas.txt", append=TRUE)
     write(toString(summary(lmVx)$coefficients[,1]), file = "sin_betas.txt", append=TRUE)
     write(toString(summary(lmVy)$coefficients[,1]), file = "sin_betas.txt", append=TRUE)
     write(toString(summary(lmVz)$coefficients[,1]), file = "sin_betas.txt", append=TRUE)
}
```

